!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).SpiderJS=t()}(this,(function(){"use strict";var e=function(){function e(e){this.config=Object.assign({},e)}return e.prototype.analyze=function(e){var t=this;return new Promise((function(n,r){try{var o=t.detectType(e),i=t.extractDependencies(e),a=t.checkForVulnerabilities(e),c={type:o,dependencies:i,vulnerabilities:a,size:e.length,isMinified:e.length>5e3&&e.split(/\r\n|\r|\n/).length<10};n(c)}catch(e){r(e)}}))},e.prototype.detectType=function(e){return e.includes("__webpack_require__")?"webpack":e.includes("define.amd")?"requirejs":e.includes("ROLLUP_CHUNK_ID")?"rollup":e.includes("System.register")?"systemjs":"unknown"},e.prototype.extractDependencies=function(e){for(var t=[],n=/(?:import|require)\s*\(?[\s]*['"](.*?)['"][\s]*\)?/g,r=void 0;null!==(r=n.exec(e));)t.push(r[1]);return t},e.prototype.checkForVulnerabilities=function(e){var t=[];return e.includes("eval(")&&t.push({type:"eval",severity:"high",description:"Direct eval usage found"}),e.includes("document.write(")&&t.push({type:"document.write",severity:"medium",description:"Document.write usage found"}),e.match(/(\W|^)innerHTML\s*=/i)&&t.push({type:"innerHTML",severity:"medium",description:"Direct innerHTML assignment"}),e.includes("new Function(")&&t.push({type:"Function",severity:"high",description:"Dynamic function creation"}),t},e}(),t=function(){function t(e){this.analyzer=new e}return t.prototype.analyze=function(e){return this.analyzer.analyze(e)},t}();return{BundleAnalyzer:e,AnalyzerFactory:t}})); 